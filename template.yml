AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: Python file including external library
Resources:

  SudoCoinsSurveyEndFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: survey_end.lambda_handler
      Runtime: python3.8
      FunctionName: SudoCoinsSurveyEnd
      CodeUri: ./src
      MemorySize: 512

  SudoCoinsTakeSurveyFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: take_survey.lambda_handler
      Runtime: python3.8
      FunctionName: SudoCoinsTakeSurvey
      CodeUri: ./src

  SudoCoinsEndTransactionFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: end_transaction.lambda_handler
      Runtime: python3.8
      FunctionName: SudoCoinsEndTransaction
      CodeUri: ./src
      MemorySize: 512

  CashOutFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: cash_out.lambda_handler
      Runtime: python3.8
      FunctionName: SudoCoinsCashOut
      CodeUri: ./src

  UpdateProfileFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: update_profile.lambda_handler
      Runtime: python3.8
      FunctionName: UpdateProfile
      CodeUri: ./src

  SetCurrencyFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: setCurrency.lambda_handler
      Runtime: python3.8
      FunctionName: setCurrency
      CodeUri: ./src

  contactFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: contact.lambda_handler
      Runtime: python3.8
      FunctionName: contact
      CodeUri: ./src

  exchangeRatesFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: getRates.lambda_handler
      Runtime: python3.8
      FunctionName: getRates
      CodeUri: ./src/ecommerce

  dynataRedirectFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: dynataRedirect.lambda_handler
      Runtime: python3.8
      FunctionName: dynataRedirect
      CodeUri: ./src

  dynataCallbackFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: dynataCallback.lambda_handler
      Runtime: python3.8
      FunctionName: dynataCallback
      CodeUri: ./src

  setConsentFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: setConsent.lambda_handler
      Runtime: python3.8
      FunctionName: setConsent
      CodeUri: ./src

  getProfileFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: getProfile.lambda_handler
      Runtime: python3.8
      FunctionName: getProfile
      Description: Gets all data for displaying the profil page
      MemorySize: 512
      CodeUri: ./src

  moreHistoryFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: moreHistory.lambda_handler
      Runtime: python3.8
      FunctionName: moreHistory
      CodeUri: ./src

  checkoutFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: checkout.lambda_handler
      Runtime: python3.8
      FunctionName: checkout
      CodeUri: ./src/ecommerce

  getGiftCardFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: getGiftCard.lambda_handler
      Runtime: python3.8
      FunctionName: getGiftCard
      CodeUri: ./src/ecommerce

  coinbaseCallback:
    Type: AWS::Serverless::Function
    Properties:
      Handler: coinbaseCallback.lambda_handler
      Runtime: python3.8
      FunctionName: coinbaseCallback
      CodeUri: ./src

  lucidRedirectFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: lucidRedirect.lambda_handler
      Runtime: python3.8
      FunctionName: lucidRedirect
      CodeUri: ./src

  nextStepFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: nextStep.lambda_handler
      Runtime: python3.8
      FunctionName: nextStep
      CodeUri: ./src

  rfgCallbackFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: rfgCallback.lambda_handler
      Runtime: python3.8
      FunctionName: rfgCallback
      CodeUri: ./src

  updateCashOutFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: updateCashOut.lambda_handler
      Runtime: python3.8
      FunctionName: updateCashOut
      CodeUri: ./src

  adminTrafficReportFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: traffic_report.lambda_handler
      Runtime: python3.8
      FunctionName: adminTrafficReport
      CodeUri: ./src/admin

  adminTrafficReportCounterStoreFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: traffic_report_counter_store.lambda_handler
      Runtime: python3.8
      FunctionName: adminTrafficReportCounterStore
      CodeUri: ./src/admin
      Policies:
        - DynamoDBCrudPolicy
      Events:
        SnsEvent:
          Type: SNS
          Properties:
            Topic: arn:aws:sns:us-west-2:977566059069:transaction-event

  adminTrafficReportChartDataFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: traffic_report_chart_data.lambda_handler
      Runtime: python3.8
      FunctionName: adminTrafficReportChartData
      CodeUri: ./src/admin
      Policies:
        - DynamoDBReadPolicy

  adminPayoutListFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: payouts.lambda_handler
      Runtime: python3.8
      FunctionName: adminPayoutList
      CodeUri: ./src/admin

  adminUserDetailsFunction:
    Type: AWS::Serverless::Function
    Properties:
      Handler: user_details.lambda_handler
      Runtime: python3.8
      FunctionName: adminUserDetails
      CodeUri: ./src/admin

  adminVerify:
    Type: AWS::Serverless::Function
    Properties:
      Handler: admin_verify.lambda_handler
      Runtime: python3.8
      FunctionName: adminVerify
      CodeUri: ./src/admin

  autoVerify:
    Type: AWS::Serverless::Function
    Properties:
      Handler: auto_verify.lambda_handler
      Runtime: python3.8
      FunctionName: autoVerify
      CodeUri: ./src
